[Interface]
PrivateKey = {{ wg_private_key }}
Address = {{ wg_address }}/32
ListenPort = 51820
PostUp = iptables -A FORWARD -i %i -j ACCEPT
PostUp = iptables -A FORWARD -o %i -j ACCEPT
PostDown = iptables -D FORWARD -i %i -j ACCEPT
PostDown = iptables -D FORWARD -o %i -j ACCEPT

# Mesh Peers
{% for peer in mesh_peers %}
[Peer]
PublicKey = {{ peer.wg_public_key }}
AllowedIPs = {{ peer.wg_address }}/32, 10.1.10.0/24
Endpoint = {{ peer.wg_endpoint }}:51820
PersistentKeepalive = 25
{% endfor %}

# Edge Gateways
{% for peer in edge_gateways %}
[Peer]
PublicKey = {{ peer.wg_public_key }}
AllowedIPs = 10.1.2.0/24, 10.1.3.0/24
Endpoint = {{ peer.wg_endpoint }}:51820
PersistentKeepalive = 25
{% endfor %}

# Edge Clients
{% for peer in edge_clients %}
[Peer]
PublicKey = {{ peer.wg_public_key }}
AllowedIPs = {{ peer.wg_address }}/32
{% endfor %}
